FROM node:alpine

ENV PORT 8000

RUN mkdir -p /usr/app
WORKDIR /usr/app

ENV NEXT_PUBLIC_SSCX_LIVE_CONTENT=true
ENV NEXT_PUBLIC_NEXUS_TOKEN=eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCXzhoTzFhWnBEVl8wejI5R1FRR0lSUTZiLVZldVhoYm9VcGJSOHpZZXJBIn0.eyJqdGkiOiJjNTdhNmFkMy02ZWNhLTQwYzQtYTdmZC03ZGY4ZDcwYzNiZWEiLCJleHAiOjE2OTg3NzE1MTcsIm5iZiI6MCwiaWF0IjoxNjEyNDU3OTE3LCJpc3MiOiJodHRwczovL2JicC5lcGZsLmNoL25leHVzL2F1dGgvcmVhbG1zL3NlcnZpY2UtYWNjb3VudHMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiZjMwZTU5MjYtOTEwNi00MDMwLThiZTctYWM1MzJhYjA3YjkwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoic3NjeC1wb3J0YWwiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiJmM2U5MzlkNC01MTE5LTRmZDItOTNiNy1hMTY5MDI2NjRjZWEiLCJhY3IiOiIxIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImNsaWVudEhvc3QiOiI3Ny41Ny4xNDYuMTEzIiwiY2xpZW50SWQiOiJzc2N4LXBvcnRhbCIsInByZWZlcnJlZF91c2VybmFtZSI6InNlcnZpY2UtYWNjb3VudC1zc2N4LXBvcnRhbCIsImNsaWVudEFkZHJlc3MiOiI3Ny41Ny4xNDYuMTEzIiwiZW1haWwiOiJzZXJ2aWNlLWFjY291bnQtc3NjeC1wb3J0YWxAcGxhY2Vob2xkZXIub3JnIn0.iHGs2LqCicpr1q6bhEUBxoEGFANR97mEemgHfmytLCg5rUEw3PYwb58-oFJ6BC08ew9--FWnpkExvyo0z00fJ6MULKACxwHYP8w88qAPKp1Dlk7Y0jt3DezlflNAxSOHoOgvwB5C1QF3YR9PszA3TVx_zrumZxmGl2kCK0cnHuZSDqLvB-hCSIwQfjOswcSPh3vvxDnS8Y0qp65JMWOEmbe1kdevtK2K7hTG0MkQYl6i9efiLoLgQRlIaMWugtFx1AvQna7cjdfCqwQMAyvknHSsA4A7xduM_95kcX5lVYLnCnvACr2LvB0HBueZkVfe08aeUFGy8fS4P8iRVBKmBg

# Installing dependencies
COPY package*.json /usr/app/
COPY yarn.lock /usr/app/
RUN yarn install

# Copying source files
COPY . /usr/app

# Building app
RUN yarn run build && chmod -R 777 .next/cache

EXPOSE 8000

# Running the app
CMD "yarn" "run" "start" "-p" "8000"
